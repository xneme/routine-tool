# Phase 01.1: UI Refinements - Research

**Researched:** 2026-01-29
**Domain:** Jetpack Compose Material 3 UI design and visual hierarchy
**Confidence:** HIGH

## Summary

This research focuses on implementing visual hierarchy and UI refinements in a Jetpack Compose Material 3 Android application. The phase addresses 10 specific UI polish items identified through user feedback: card visual distinction, spacing density, section separation, header consistency, checkbox positioning, icon colorization, semantic color tinting for task states, collapsible UI elements, and header removal.

The standard approach uses Material 3's built-in components and color system with minimal custom implementation. Material 3 provides comprehensive solutions for each requirement through ElevatedCard for visual distinction, Arrangement.spacedBy() for spacing control, HorizontalDivider for section separation, surface container colors for subtle tinting, and AnimatedVisibility for collapsible content.

The project currently uses Compose BOM 2024.12.01, which provides Material 3 with all necessary components including HorizontalDivider, surface container colors, and animation APIs. All refinements can be achieved through configuration changes and standard Material 3 patterns without custom components.

**Primary recommendation:** Use Material 3's ElevatedCard with 2dp elevation, surface container color variants for subtle state tinting (errorContainer for overdue, tertiaryContainer for done), HorizontalDivider for section separation, and AnimatedVisibility for collapsible reschedule options. Avoid custom color systems or hand-rolled animation—Material 3 provides all necessary components.

## Standard Stack

The established libraries/tools for this domain:

### Core
| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| Compose BOM | 2024.12.01 | Material 3 components | Official Jetpack Compose distribution with version-aligned Material 3 |
| Material 3 | (via BOM) | UI components and theming | Android's current design system with comprehensive color roles and components |
| compose.material-icons-extended | (via BOM) | Icon library | Extended Material Icons including ExpandMore/ExpandLess for collapsible UI |
| androidx.compose.animation | (via BOM) | Animation APIs | Built-in animation support including AnimatedVisibility and animateContentSize |

### Supporting
| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| ui-tooling-preview | (via BOM) | Preview support | Development-time previewing of UI refinements |
| ui-tooling | (via BOM) | Debug UI inspection | Debugging layout issues and spacing |

### Alternatives Considered
| Instead of | Could Use | Tradeoff |
|------------|-----------|----------|
| Material 3 | Material 2 | Material 2 is deprecated, lacks surface container colors and updated elevation system |
| ElevatedCard | OutlinedCard | Outlined cards use borders instead of elevation—less suitable for task cards where shadow creates depth |
| Material Icons | Custom icons | Material Icons already include all needed icons (Schedule, Bookmark, ExpandMore) with consistent sizing |

**Installation:**
Already installed via current build.gradle.kts—no additional dependencies needed.

## Architecture Patterns

### Recommended Component Structure
```
ui/
├── components/
│   ├── TaskCard.kt        # Enhanced with ElevatedCard, tinting, checkbox repositioning
│   ├── DeadlineBadge.kt   # Enhanced with colored icon tints
│   └── SectionHeader.kt   # New component for consistent section headers
├── screens/
│   └── tasklist/
│       └── TaskListScreen.kt  # Enhanced with dividers, active tasks header, no TopAppBar
└── theme/
    └── Color.kt           # Extended with semantic colors (success, errorContainer variants)
```

### Pattern 1: Card Visual Distinction with Elevation

**What:** Use ElevatedCard instead of regular Card to create shadow-based separation between cards

**When to use:** For list items that need clear visual boundaries without harsh borders

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/components/card
@Composable
fun TaskCard(
    task: Task,
    isOverdue: Boolean,
    modifier: Modifier = Modifier
) {
    ElevatedCard(
        elevation = CardDefaults.cardElevation(
            defaultElevation = 2.dp
        ),
        colors = CardDefaults.cardColors(
            containerColor = when {
                task.isCompleted -> MaterialTheme.colorScheme.tertiaryContainer
                isOverdue -> MaterialTheme.colorScheme.errorContainer
                else -> MaterialTheme.colorScheme.surfaceContainerLow
            }
        ),
        modifier = modifier.fillMaxWidth()
    ) {
        // Card content
    }
}
```

### Pattern 2: Spacing Density Control

**What:** Use Arrangement.spacedBy() with different values for collapsed vs expanded states

**When to use:** For adjusting list density based on content visibility

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/lists
LazyColumn(
    contentPadding = PaddingValues(horizontal = 16.dp, vertical = 8.dp),
    verticalArrangement = Arrangement.spacedBy(8.dp), // Tight spacing for collapsed cards
) {
    items(tasks) { task ->
        TaskCard(
            task = task,
            isExpanded = expandedTaskId == task.id,
            // Expanded card uses animateContentSize() internally
        )
    }
}
```

**Rationale:** 8.dp spacing provides visual separation without excessive whitespace when cards are collapsed. Individual card expansion is handled by Modifier.animateContentSize() on the card itself.

### Pattern 3: Section Visual Separation

**What:** Use HorizontalDivider with vertical spacing to create clear section boundaries

**When to use:** Between major sections (Overdue, Active, Done) in a list

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/components/divider
// Updated 2026-01-15
LazyColumn {
    // Overdue section
    item {
        Text(
            text = "Overdue",
            style = MaterialTheme.typography.titleMedium,
            color = MaterialTheme.colorScheme.onSurfaceVariant,
            modifier = Modifier.padding(vertical = 8.dp)
        )
    }
    items(overdueTasks) { /* cards */ }

    // Section divider
    item {
        HorizontalDivider(
            thickness = 1.dp,
            color = MaterialTheme.colorScheme.outlineVariant,
            modifier = Modifier.padding(vertical = 16.dp)
        )
    }

    // Active tasks section
    item {
        Text(
            text = "Tasks",
            style = MaterialTheme.typography.titleMedium,
            color = MaterialTheme.colorScheme.onSurfaceVariant,
            modifier = Modifier.padding(vertical = 8.dp)
        )
    }
    items(activeTasks) { /* cards */ }
}
```

### Pattern 4: Semantic Color Tinting

**What:** Use Material 3 container colors (errorContainer, tertiaryContainer) for subtle state indication

**When to use:** Differentiating task states (overdue, done) while maintaining shame-free UX

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/designsystems/material3
@Composable
fun TaskCard(task: Task, isOverdue: Boolean) {
    ElevatedCard(
        colors = CardDefaults.cardColors(
            containerColor = when {
                task.isCompleted -> MaterialTheme.colorScheme.tertiaryContainer
                isOverdue -> MaterialTheme.colorScheme.errorContainer
                else -> MaterialTheme.colorScheme.surfaceContainerLow
            }
        )
    ) {
        // Content
    }
}
```

**Important:** Material 3's errorContainer and tertiaryContainer provide subtle, muted tints that indicate state without harsh emphasis. In light theme, errorContainer is a soft red-tinted surface, not a bright error red.

### Pattern 5: Icon Color Tinting

**What:** Apply semantic colors to individual icons using the tint parameter

**When to use:** Providing visual cues through icon colors while maintaining monochrome as base

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/graphics/images/material
Icon(
    imageVector = Icons.Filled.Schedule,
    contentDescription = "Soft deadline",
    tint = MaterialTheme.colorScheme.primary, // Calm accent color
    modifier = Modifier.size(16.dp)
)

Icon(
    imageVector = Icons.Filled.Bookmark,
    contentDescription = "Hard deadline",
    tint = MaterialTheme.colorScheme.secondary,
    modifier = Modifier.size(16.dp)
)
```

### Pattern 6: Checkbox Positioning

**What:** Use Row layout with checkbox after content, pushed to right side

**When to use:** Placing interactive elements in predictable thumb-accessible positions

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/layouts/basics
Row(
    modifier = Modifier.fillMaxWidth(),
    verticalAlignment = Alignment.CenterVertically,
    horizontalArrangement = Arrangement.SpaceBetween
) {
    // Left side: title and content
    Column(modifier = Modifier.weight(1f)) {
        Text(text = task.title)
    }

    // Right side: deadline icons and checkbox
    Row(
        verticalAlignment = Alignment.CenterVertically,
        horizontalArrangement = Arrangement.spacedBy(8.dp)
    ) {
        if (task.softDeadline != null || task.hardDeadline != null) {
            DeadlineBadge(...)
        }
        Checkbox(
            checked = task.isCompleted,
            onCheckedChange = { /* handle */ }
        )
    }
}
```

### Pattern 7: Collapsible Content with AnimatedVisibility

**What:** Use AnimatedVisibility for expand/collapse behavior with expandVertically/shrinkVertically

**When to use:** Hiding secondary actions until user requests them

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/animation/quick-guide
// Updated 2026-01-19
var isRescheduleExpanded by remember { mutableStateOf(false) }

Column {
    TextButton(onClick = { isRescheduleExpanded = !isRescheduleExpanded }) {
        Text("Reschedule")
        Icon(
            imageVector = if (isRescheduleExpanded)
                Icons.Filled.ExpandLess
            else
                Icons.Filled.ExpandMore,
            contentDescription = null
        )
    }

    AnimatedVisibility(
        visible = isRescheduleExpanded,
        enter = expandVertically(),
        exit = shrinkVertically()
    ) {
        Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {
            TextButton(onClick = { /* Tomorrow */ }) { Text("Tomorrow") }
            TextButton(onClick = { /* +1 week */ }) { Text("+1 week") }
            TextButton(onClick = { /* Remove */ }) { Text("Remove deadline") }
        }
    }
}
```

**Rationale:** AnimatedVisibility removes content from composition when hidden, improving accessibility compared to alpha-based hiding. expandVertically/shrinkVertically provides smooth accordion-style animation.

### Pattern 8: Removing TopAppBar from Scaffold

**What:** Omit the topBar parameter from Scaffold

**When to use:** When app header creates unnecessary visual weight

**Example:**
```kotlin
// Source: https://developer.android.com/develop/ui/compose/components/scaffold
@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun TaskListScreen() {
    Scaffold(
        // No topBar parameter = no TopAppBar
        floatingActionButton = {
            FloatingActionButton(onClick = { /* Add task */ }) {
                Icon(Icons.Filled.Add, contentDescription = "Add task")
            }
        }
    ) { paddingValues ->
        LazyColumn(modifier = Modifier.padding(paddingValues)) {
            // Content
        }
    }
}
```

### Anti-Patterns to Avoid

- **Custom shadow/border systems:** Material 3's elevation system is designed for accessibility and cross-platform consistency. Custom shadows break Material Design guidelines and may not adapt to dark theme properly.

- **Harsh error colors:** Using bright red (Color.Red) for overdue tasks violates the shame-free UX requirement. errorContainer provides appropriate subtlety.

- **Manual animation with alpha:** Using Modifier.alpha(if (visible) 1f else 0f) keeps content in composition, causing accessibility issues. Always use AnimatedVisibility for show/hide.

- **Spacer for inter-item spacing:** Using Spacer composables between list items creates verbose code and makes density changes difficult. Arrangement.spacedBy() is the standard approach.

- **Custom card components:** Material 3 provides ElevatedCard, OutlinedCard, and Card. Building custom wrappers adds complexity without benefit.

## Don't Hand-Roll

Problems that look simple but have existing solutions:

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Card elevation/shadow | Custom Box with shadow modifiers | ElevatedCard with CardDefaults.cardElevation() | Material 3's elevation system handles light/dark theme, accessibility, and platform conventions automatically |
| Section dividers | Custom Box with background color | HorizontalDivider | Handles thickness, color, and Material theme integration. Added in Material 3 (replaces deprecated Divider) |
| Collapsible content | Custom height animation with animateDpAsState | AnimatedVisibility with expandVertically/shrinkVertically | Removes content from composition when hidden (accessibility), handles enter/exit transitions, works with LazyColumn |
| Subtle state colors | Custom Color() values | MaterialTheme.colorScheme.errorContainer, tertiaryContainer, surfaceContainerLow | Automatically adapts to light/dark theme, follows Material color relationships, maintains accessibility contrast |
| Icon colors | Individual Color() values per icon | MaterialTheme.colorScheme.primary, secondary, tertiary | Ensures color harmony with theme, supports dynamic color (Material You), adapts to dark mode |
| List spacing | Individual Spacer or padding per item | Arrangement.spacedBy() in LazyColumn | Consistent spacing, easier to adjust globally, cleaner code, respects contentPadding |
| Expand/collapse indicators | Custom rotation animation | Icons.Filled.ExpandMore / ExpandLess with AnimatedVisibility | Standard Material icons, users recognize the pattern, no custom animation needed |

**Key insight:** Material 3's color system uses tonal palettes and container colors specifically designed for subtle state indication. Custom color values often fail to maintain contrast ratios across light/dark themes and break when Material You dynamic colors are enabled.

## Common Pitfalls

### Pitfall 1: Using surface instead of surfaceContainerLow for cards

**What goes wrong:** Cards blend into background, reducing visual hierarchy

**Why it happens:** Material 3 introduced surface container variants (surfaceContainerLowest through surfaceContainerHighest) in 2024. Older Material 3 examples use surface or surfaceVariant.

**How to avoid:** Use surfaceContainerLow for default cards, surfaceVariant for de-emphasized cards. Reserve surface for the actual screen background.

**Warning signs:** Cards appear "flat" against background, especially in light mode. No visible separation between card and screen.

**Source:** The surface tint colour was replaced with new surface container alternatives: dim, bright, and five colours from container-lowest to container-highest (Material Design 3, 2026).

### Pitfall 2: Applying errorContainer without understanding tonal values

**What goes wrong:** Overdue tasks appear too bright/harsh, or text becomes unreadable due to poor contrast

**Why it happens:** errorContainer is a tonal color—in light theme it's a soft red tint, not bright red. However, text color must use onErrorContainer, not onSurface.

**How to avoid:** Always pair container colors with their "on" counterparts:
- errorContainer → onErrorContainer
- tertiaryContainer → onTertiaryContainer
- surfaceContainerLow → onSurface

**Warning signs:** Text appears low-contrast or colors look too saturated

**Example:**
```kotlin
// WRONG: Uses onSurface on errorContainer (poor contrast in some themes)
Card(
    colors = CardDefaults.cardColors(
        containerColor = MaterialTheme.colorScheme.errorContainer
    )
) {
    Text(
        text = "Overdue task",
        color = MaterialTheme.colorScheme.onSurface // WRONG
    )
}

// CORRECT: Uses onErrorContainer
Card(
    colors = CardDefaults.cardColors(
        containerColor = MaterialTheme.colorScheme.errorContainer
    )
) {
    Text(
        text = "Overdue task",
        color = MaterialTheme.colorScheme.onErrorContainer // CORRECT
    )
}
```

### Pitfall 3: Inconsistent spacing between collapsed and expanded cards

**What goes wrong:** When a card expands, the sudden height change creates jarring layout shifts for cards below

**Why it happens:** Not using Modifier.animateContentSize() on the card itself causes instant layout changes instead of smooth transitions

**How to avoid:** Apply animateContentSize() to the Card's modifier (not the content inside)

**Warning signs:** Cards below the expanded card "jump" to new positions instead of smoothly shifting

**Example:**
```kotlin
// CORRECT
ElevatedCard(
    modifier = modifier
        .fillMaxWidth()
        .animateContentSize() // Animates card height changes
) {
    Column {
        // Collapsed content
        if (isExpanded) {
            // Expanded content
        }
    }
}
```

### Pitfall 4: Overusing dividers

**What goes wrong:** Too many dividers create visual clutter and reduce their impact when actually needed

**Why it happens:** Adding dividers between every section or between individual cards

**How to avoid:** Use dividers only between major sections (Overdue, Active, Done). Use card elevation and spacing for individual card separation.

**Warning signs:** Screen feels "busy" or "gridlike," dividers lose their separating effect

**Guidance from Material Design:** "A heavy use of dividers can lead to visual noise and dilute their impact, but if strong divisions are not required, consider using white space, subheaders, or inset dividers."

### Pitfall 5: Forgetting to handle expanded state in LazyColumn

**What goes wrong:** Expanding a card in a LazyColumn can cause scroll position jumps or UI glitches

**Why it happens:** LazyColumn recycles views. If expanded state is stored in ViewModel and a card scrolls off-screen then back, its height change affects layout calculations.

**How to avoid:** Store expanded task ID in local composable state (not ViewModel). Use stable keys in items() call.

**Warning signs:** Scroll position jumps when expanding cards, or multiple cards show as expanded simultaneously

**Example:**
```kotlin
// CORRECT: Local state + stable keys
var expandedTaskId by remember { mutableStateOf<String?>(null) }

LazyColumn {
    items(tasks, key = { it.id }) { task -> // Stable key
        TaskCard(
            isExpanded = expandedTaskId == task.id,
            onExpandToggle = {
                expandedTaskId = if (expandedTaskId == task.id) null else task.id
            }
        )
    }
}
```

### Pitfall 6: Icon tint color not adapting to dark theme

**What goes wrong:** Icons look fine in light theme but become invisible or wrong tone in dark theme

**Why it happens:** Using hardcoded Color values instead of MaterialTheme.colorScheme

**How to avoid:** Always use theme colors for tints: primary, secondary, tertiary, onSurface, etc.

**Warning signs:** Icons invisible in dark mode, or colors feel "off" when switching themes

```kotlin
// WRONG
Icon(
    imageVector = Icons.Filled.Schedule,
    tint = Color(0xFF5C6BC0) // Hardcoded color
)

// CORRECT
Icon(
    imageVector = Icons.Filled.Schedule,
    tint = MaterialTheme.colorScheme.primary // Theme color
)
```

## Code Examples

Verified patterns from official sources:

### Complete Task Card with All Refinements

```kotlin
// Sources:
// - Card: https://developer.android.com/develop/ui/compose/components/card
// - Colors: https://developer.android.com/develop/ui/compose/designsystems/material3
// - Animation: https://developer.android.com/develop/ui/compose/animation/quick-guide
@Composable
fun TaskCard(
    task: Task,
    isExpanded: Boolean,
    onExpandToggle: () -> Unit,
    onComplete: () -> Unit,
    isOverdue: Boolean,
    modifier: Modifier = Modifier
) {
    var isRescheduleExpanded by remember { mutableStateOf(false) }

    ElevatedCard(
        modifier = modifier
            .fillMaxWidth()
            .animateContentSize(), // Smooth expand/collapse
        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp),
        colors = CardDefaults.cardColors(
            containerColor = when {
                task.isCompleted -> MaterialTheme.colorScheme.tertiaryContainer
                isOverdue -> MaterialTheme.colorScheme.errorContainer
                else -> MaterialTheme.colorScheme.surfaceContainerLow
            }
        )
    ) {
        Column(
            modifier = Modifier
                .clickable { onExpandToggle() }
                .padding(16.dp)
        ) {
            // Collapsed content - checkbox on right
            Row(
                modifier = Modifier.fillMaxWidth(),
                verticalAlignment = Alignment.CenterVertically,
                horizontalArrangement = Arrangement.SpaceBetween
            ) {
                Text(
                    text = task.title,
                    style = MaterialTheme.typography.bodyLarge,
                    color = if (task.isCompleted)
                        MaterialTheme.colorScheme.onTertiaryContainer
                    else if (isOverdue)
                        MaterialTheme.colorScheme.onErrorContainer
                    else
                        MaterialTheme.colorScheme.onSurface,
                    modifier = Modifier.weight(1f)
                )

                Row(
                    verticalAlignment = Alignment.CenterVertically,
                    horizontalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    if (task.softDeadline != null || task.hardDeadline != null) {
                        DeadlineBadge(
                            softDeadline = task.softDeadline,
                            hardDeadline = task.hardDeadline
                        )
                    }
                    Checkbox(
                        checked = task.isCompleted,
                        onCheckedChange = { if (it) onComplete() }
                    )
                }
            }

            // Expanded content
            if (isExpanded && isOverdue && !task.isCompleted) {
                Spacer(modifier = Modifier.height(12.dp))

                // Collapsible reschedule options
                Column {
                    TextButton(
                        onClick = { isRescheduleExpanded = !isRescheduleExpanded }
                    ) {
                        Text("Reschedule")
                        Spacer(modifier = Modifier.width(4.dp))
                        Icon(
                            imageVector = if (isRescheduleExpanded)
                                Icons.Filled.ExpandLess
                            else
                                Icons.Filled.ExpandMore,
                            contentDescription = null
                        )
                    }

                    AnimatedVisibility(
                        visible = isRescheduleExpanded,
                        enter = expandVertically(),
                        exit = shrinkVertically()
                    ) {
                        Row(
                            horizontalArrangement = Arrangement.spacedBy(8.dp)
                        ) {
                            TextButton(onClick = { /* Tomorrow */ }) {
                                Text("Tomorrow")
                            }
                            TextButton(onClick = { /* +1 week */ }) {
                                Text("+1 week")
                            }
                            TextButton(onClick = { /* Remove deadline */ }) {
                                Text("Remove deadline")
                            }
                        }
                    }
                }
            }
        }
    }
}
```

### Task List Screen with Section Headers and Dividers

```kotlin
// Source: https://developer.android.com/develop/ui/compose/lists
@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun TaskListScreen(
    onAddTask: () -> Unit,
    viewModel: TaskListViewModel = koinViewModel()
) {
    val uiState by viewModel.uiState.collectAsState()
    var expandedTaskId by remember { mutableStateOf<String?>(null) }

    Scaffold(
        // No topBar parameter - removed per requirements
        floatingActionButton = {
            FloatingActionButton(onClick = onAddTask) {
                Icon(Icons.Filled.Add, contentDescription = "Add task")
            }
        }
    ) { paddingValues ->
        LazyColumn(
            modifier = Modifier
                .fillMaxSize()
                .padding(paddingValues),
            contentPadding = PaddingValues(horizontal = 16.dp, vertical = 8.dp),
            verticalArrangement = Arrangement.spacedBy(8.dp) // Reduced spacing for density
        ) {
            // Overdue section
            if (uiState.overdueTasks.isNotEmpty()) {
                item {
                    Text(
                        text = "Overdue",
                        style = MaterialTheme.typography.titleMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant,
                        modifier = Modifier.padding(vertical = 8.dp)
                    )
                }
                items(uiState.overdueTasks, key = { it.id }) { task ->
                    TaskCard(
                        task = task,
                        isExpanded = expandedTaskId == task.id,
                        onExpandToggle = {
                            expandedTaskId = if (expandedTaskId == task.id) null else task.id
                        },
                        isOverdue = true
                    )
                }

                // Section divider
                item {
                    HorizontalDivider(
                        thickness = 1.dp,
                        color = MaterialTheme.colorScheme.outlineVariant,
                        modifier = Modifier.padding(vertical = 16.dp)
                    )
                }
            }

            // Active tasks section - now has header
            if (uiState.activeTasks.isNotEmpty()) {
                item {
                    Text(
                        text = "Tasks",
                        style = MaterialTheme.typography.titleMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant,
                        modifier = Modifier.padding(vertical = 8.dp)
                    )
                }
                items(uiState.activeTasks, key = { it.id }) { task ->
                    TaskCard(
                        task = task,
                        isExpanded = expandedTaskId == task.id,
                        onExpandToggle = {
                            expandedTaskId = if (expandedTaskId == task.id) null else task.id
                        },
                        isOverdue = false
                    )
                }
            }

            // Done section
            if (uiState.doneTasks.isNotEmpty()) {
                item {
                    HorizontalDivider(
                        thickness = 1.dp,
                        color = MaterialTheme.colorScheme.outlineVariant,
                        modifier = Modifier.padding(vertical = 16.dp)
                    )
                }
                item {
                    Text(
                        text = "Done",
                        style = MaterialTheme.typography.titleMedium,
                        color = MaterialTheme.colorScheme.onSurfaceVariant,
                        modifier = Modifier.padding(vertical = 8.dp)
                    )
                }
                items(uiState.doneTasks, key = { it.id }) { task ->
                    TaskCard(
                        task = task,
                        isExpanded = expandedTaskId == task.id,
                        onExpandToggle = {
                            expandedTaskId = if (expandedTaskId == task.id) null else task.id
                        },
                        isOverdue = false
                    )
                }
            }
        }
    }
}
```

### Colored Deadline Badge Icons

```kotlin
// Source: https://developer.android.com/develop/ui/compose/graphics/images/material
@Composable
fun DeadlineBadge(
    softDeadline: Instant?,
    hardDeadline: Instant?,
    modifier: Modifier = Modifier
) {
    Row(
        modifier = modifier,
        horizontalArrangement = Arrangement.spacedBy(4.dp),
        verticalAlignment = Alignment.CenterVertically
    ) {
        if (softDeadline != null) {
            Icon(
                imageVector = Icons.Filled.Schedule,
                contentDescription = "Soft deadline",
                tint = MaterialTheme.colorScheme.primary, // Colored, not monochrome
                modifier = Modifier.size(16.dp)
            )
        }
        if (hardDeadline != null) {
            Icon(
                imageVector = Icons.Filled.Bookmark,
                contentDescription = "Hard deadline",
                tint = MaterialTheme.colorScheme.secondary, // Different color for distinction
                modifier = Modifier.size(16.dp)
            )
        }
    }
}
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| Divider() | HorizontalDivider() / VerticalDivider() | Material 3 1.1.0+ (2023) | Divider() is deprecated. HorizontalDivider provides explicit naming and better API |
| surface / surfaceVariant for cards | surfaceContainerLow / surfaceContainerHigh | Material 3 2024 update | New surface container hierarchy (lowest→highest) provides better tonal layering |
| Custom expand/collapse animations | AnimatedVisibility with expandVertically | Compose 1.0+ | Removes content from composition, improving accessibility and performance |
| Deprecated Arrangement.spacedBy() in older Compose | Standard Arrangement.spacedBy() | Stable since Compose 1.0 | Now the recommended approach for list spacing |
| Material You primary/secondary only | Extended with tertiary, error, custom colors | Material 3 (2021+) | More semantic colors available for state indication |

**Deprecated/outdated:**
- **Divider()**: Replaced by HorizontalDivider() and VerticalDivider() for clarity
- **Using surface for card backgrounds**: Use surfaceContainerLow, surfaceContainer, or surfaceContainerHigh for proper layering
- **Manual state expansion with if/else on alpha**: Use AnimatedVisibility for accessibility
- **Hardcoded elevation values without CardDefaults**: CardDefaults.cardElevation() provides Material-compliant defaults

## Open Questions

Things that couldn't be fully resolved:

1. **Exact tint intensity for overdue/done states**
   - What we know: errorContainer and tertiaryContainer provide subtle tints that work in light/dark themes
   - What's unclear: Whether the default tint intensity is "subtle enough" for shame-free UX, or if we need custom lighter variants
   - Recommendation: Start with errorContainer/tertiaryContainer. If user feedback indicates the tint is too strong, we can create custom colors using Color.copy(alpha = 0.5f) to lighten. This is acceptable since we're not replacing the color system, just adjusting intensity.

2. **Section divider vs spacing-only separation**
   - What we know: Material Design states "heavy use of dividers can lead to visual noise" and suggests considering white space
   - What's unclear: Whether HorizontalDivider is needed between all sections, or only between Overdue and Active (with white space for Active→Done)
   - Recommendation: Implement dividers between all sections initially. If user feedback indicates too much visual weight, remove Active→Done divider and use larger vertical spacing (24.dp) instead.

3. **Checkbox tap target size vs visual size**
   - What we know: Material 3 Checkbox has a 48.dp minimum touch target for accessibility
   - What's unclear: Whether placing checkbox on the right creates thumb-blocking issues on small screens when tapping
   - Recommendation: Implement right-side checkbox as specified. If user testing shows thumb-blocking issues, consider left-side positioning or increasing spacing between checkbox and deadline icons.

## Sources

### Primary (HIGH confidence)
- [Card - Jetpack Compose | Android Developers](https://developer.android.com/develop/ui/compose/components/card) - Card types and elevation (updated 2026-01-26)
- [Material Design 3 in Compose | Android Developers](https://developer.android.com/develop/ui/compose/designsystems/material3) - Color scheme and theming
- [Lists and grids | Android Developers](https://developer.android.com/develop/ui/compose/lists) - Arrangement.spacedBy() and spacing best practices
- [Divider | Jetpack Compose | Android Developers](https://developer.android.com/develop/ui/compose/components/divider) - HorizontalDivider usage (updated 2026-01-15)
- [Quick guide to Animations in Compose | Android Developers](https://developer.android.com/develop/ui/compose/animation/quick-guide) - AnimatedVisibility (updated 2026-01-19)
- [Icons | Jetpack Compose | Android Developers](https://developer.android.com/develop/ui/compose/graphics/images/material) - Icon tinting
- [Scaffold | Android Developers](https://developer.android.com/develop/ui/compose/components/scaffold) - Scaffold without TopAppBar
- [Compose layout basics | Android Developers](https://developer.android.com/develop/ui/compose/layouts/basics) - Row/Column alignment

### Secondary (MEDIUM confidence)
- [Color roles - Material Design 3](https://m3.material.io/styles/color/roles) - Error, errorContainer, and semantic color usage
- [Cards – Material Design 3](https://m3.material.io/components/cards/guidelines) - Card elevation defaults (2dp)
- [Divider – Material Design 3](https://m3.material.io/components/divider/guidelines) - Section divider guidance
- [Layout and spacing - Material Design 3](https://m3.material.io/foundations/layout/understanding-layout/spacing) - Spacing foundations
- [Jetpack Compose Material3 surfaceContainer variants](https://www.lorenzovainigli.com/blog/jetpack-compose-material3-surfacecontainer-variants/) - Surface container color explanation (2024)

### Tertiary (LOW confidence)
- [Medium: Expand & Collapse Animation for Accordion in Jetpack Compose](https://medium.com/@danimahardhika/expand-collapse-animation-for-accordion-in-jetpack-compose-941158ad864c) - Collapsible UI patterns
- [Medium: Mastering Jetpack Compose Cards](https://medium.com/@ramadan123sayed/mastering-jetpack-compose-cards-complete-guide-to-material-3-cards-a41ce7af4716) - Card usage examples

## Metadata

**Confidence breakdown:**
- Standard stack: HIGH - Using existing Compose BOM 2024.12.01, verified from libs.versions.toml
- Architecture: HIGH - All patterns from official Android Developers documentation updated 2026
- Card elevation: HIGH - Official documentation and Material Design 3 guidelines
- Color tinting: MEDIUM - errorContainer/tertiaryContainer usage verified, but exact visual "subtlety" requires user validation
- Spacing density: HIGH - Arrangement.spacedBy() is standard, 8.dp value is common practice
- Collapsible UI: HIGH - AnimatedVisibility with expandVertically is official recommendation
- Pitfalls: HIGH - Based on official docs and Material Design guidelines

**Research date:** 2026-01-29
**Valid until:** 2026-02-28 (30 days - Material 3 is stable, but new Compose BOM releases monthly)

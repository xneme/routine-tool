---
phase: 01.1-ui-refinements
plan: 02
type: execute
wave: 2
depends_on: ["01.1-01"]
files_modified:
  - app/src/main/java/com/routinetool/ui/screens/tasklist/TaskListScreen.kt
autonomous: false

must_haves:
  truths:
    - "App header (Routine Tool) is removed from top of screen"
    - "Active tasks section has a 'Tasks' header like Overdue and Done sections"
    - "Sections are separated by horizontal dividers"
    - "Task list has consistent 8.dp spacing between cards"
    - "Done tasks no longer have alpha modifier (replaced by card tinting from Plan 01)"
  artifacts:
    - path: "app/src/main/java/com/routinetool/ui/screens/tasklist/TaskListScreen.kt"
      provides: "TaskListScreen without TopAppBar, with section dividers and Tasks header"
      contains: "HorizontalDivider"
  key_links:
    - from: "TaskListScreen.kt"
      to: "Scaffold"
      via: "removed topBar parameter"
      pattern: "Scaffold\\([^)]*floatingActionButton"
    - from: "TaskListScreen.kt"
      to: "HorizontalDivider"
      via: "section separation"
      pattern: "HorizontalDivider.*outlineVariant"
---

<objective>
Refine TaskListScreen layout for better visual hierarchy and section separation.

Purpose: Address user feedback about sections blending together, missing "Tasks" header for active section, and unnecessary app header taking up space. Implement Material 3 dividers and clean up the list structure.

Output: Enhanced TaskListScreen.kt with removed app header, section dividers, "Tasks" header for active section, and removed alpha modifier on done tasks.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01.1-ui-refinements/01.1-RESEARCH.md
@.planning/phases/01.1-ui-refinements/01.1-01-SUMMARY.md

# Existing file to modify
@app/src/main/java/com/routinetool/ui/screens/tasklist/TaskListScreen.kt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove TopAppBar and restructure list layout</name>
  <files>app/src/main/java/com/routinetool/ui/screens/tasklist/TaskListScreen.kt</files>
  <action>
Modify TaskListScreen.kt to implement the following changes:

1. **Remove TopAppBar:**
   - Delete the entire `topBar = { ... }` parameter from Scaffold
   - Keep the floatingActionButton parameter
   - The Scaffold will now only have floatingActionButton and content

2. **Add HorizontalDivider import:**
   ```kotlin
   import androidx.compose.material3.HorizontalDivider
   ```

3. **Add section dividers between sections:**
   - After Overdue section items (before Active), add a divider:
   ```kotlin
   item {
       HorizontalDivider(
           thickness = 1.dp,
           color = MaterialTheme.colorScheme.outlineVariant,
           modifier = Modifier.padding(vertical = 16.dp)
       )
   }
   ```
   - After Active section items (before Done), add a divider:
   ```kotlin
   item {
       HorizontalDivider(
           thickness = 1.dp,
           color = MaterialTheme.colorScheme.outlineVariant,
           modifier = Modifier.padding(vertical = 16.dp)
       )
   }
   ```

4. **Add "Tasks" header for Active section:**
   - Before the active tasks items, add:
   ```kotlin
   if (uiState.activeTasks.isNotEmpty()) {
       item {
           Text(
               text = "Tasks",
               style = MaterialTheme.typography.titleMedium,
               color = MaterialTheme.colorScheme.onSurfaceVariant,
               modifier = Modifier.padding(vertical = 8.dp)
           )
       }
       items(uiState.activeTasks, key = { it.id }) { task ->
           // existing TaskCard code
       }
   }
   ```

5. **Remove alpha modifier from Done tasks:**
   - Find the Done section TaskCard and remove `modifier = Modifier.alpha(0.6f)`
   - Plan 01's tertiaryContainer color provides the visual distinction now
   - Keep all other parameters the same

6. **Update section header style:**
   - Change `style = MaterialTheme.typography.labelLarge` to `style = MaterialTheme.typography.titleMedium` for consistency
   - Apply to both "Overdue" and "Done" headers

7. **Remove the Spacer items:**
   - Delete `item { Spacer(modifier = Modifier.height(16.dp)) }` between sections
   - The HorizontalDivider with padding replaces this functionality

8. **Conditional divider logic:**
   - Only show divider after Overdue if both Overdue AND (Active OR Done) exist
   - Only show divider after Active if both Active AND Done exist
   - Structure:
   ```kotlin
   // Overdue section
   if (uiState.overdueTasks.isNotEmpty()) {
       item { Text("Overdue", ...) }
       items(uiState.overdueTasks, ...) { ... }

       // Divider only if there's something after
       if (uiState.activeTasks.isNotEmpty() || uiState.doneTasks.isNotEmpty()) {
           item { HorizontalDivider(...) }
       }
   }

   // Active section
   if (uiState.activeTasks.isNotEmpty()) {
       item { Text("Tasks", ...) }
       items(uiState.activeTasks, ...) { ... }

       // Divider only if Done section follows
       if (uiState.doneTasks.isNotEmpty()) {
           item { HorizontalDivider(...) }
       }
   }

   // Done section
   if (uiState.doneTasks.isNotEmpty()) {
       item { Text("Done", ...) }
       items(uiState.doneTasks, ...) { ... }
   }
   ```

IMPORTANT: Keep all existing functionality (loading state, empty state, expanded task tracking, ViewModel interactions).
  </action>
  <verify>
Run `./gradlew assembleDebug` from project root - build should complete without errors.
Verify the TopAppBar reference is completely removed.
Verify HorizontalDivider is imported and used correctly.
  </verify>
  <done>
TaskListScreen has no TopAppBar, displays "Tasks" header for active section, shows HorizontalDividers between sections, and done tasks no longer use alpha modifier.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of UI refinements</name>
  <what-built>
Complete UI refinements for Phase 1.1:
- Task cards have subtle elevation shadows (not flat blocks)
- Overdue tasks have subtle red-tinted background (errorContainer)
- Completed tasks have subtle green-tinted background (tertiaryContainer)
- Active tasks have neutral background (surfaceContainerLow)
- Checkbox is positioned on right side of each card
- Deadline icons show colors (primary for soft, secondary for hard)
- Reschedule options are hidden behind collapsible "Reschedule" button
- App header "Routine Tool" is removed from top
- Sections have "Overdue", "Tasks", "Done" headers
- Sections are separated by horizontal dividers
  </what-built>
  <how-to-verify>
1. Run the app: `./gradlew installDebug` then open "Routine Tool" app on device/emulator
2. Verify empty state still works (if no tasks exist)
3. Add a test task with no deadline - verify it appears under "Tasks" header
4. Add a test task with a past soft deadline - verify it appears under "Overdue" with red tint
5. Complete a task - verify it moves to "Done" with green tint
6. Verify checkbox is on the RIGHT side of each card (under deadline icons if present)
7. Expand an overdue task - verify "Reschedule" button exists and expands to show options
8. Verify deadline icons show color (not gray)
9. Verify horizontal dividers appear between sections
10. Verify NO "Routine Tool" header at top of screen
11. Check that cards have subtle shadows making them distinct from each other
  </how-to-verify>
  <resume-signal>
Type "approved" if all 10 success criteria are met, or describe specific issues that need fixing.
  </resume-signal>
</task>

</tasks>

<verification>
After completing both tasks:

1. Build succeeds: `./gradlew assembleDebug`
2. TaskListScreen.kt contains:
   - No `topBar` parameter in Scaffold
   - `HorizontalDivider` import and usage
   - "Tasks" header for active section
   - No `alpha(0.6f)` modifier on done TaskCards
3. Human verification confirms all 10 Phase 1.1 success criteria met
</verification>

<success_criteria>
Phase 1.1 complete when all 10 criteria verified by human:
1. Task cards are visually distinct from each other (not appearing as one block)
2. Collapsed tasks have reduced vertical spacing for better density
3. Sections (Overdue, Active, Done) are clearly separated visually
4. Active tasks section has a header like other sections
5. Checkbox positioned on right side under deadline icons
6. Icons have appropriate color coding (not monochrome)
7. Overdue tasks have subtle red tint for differentiation
8. Done tasks have subtle green tint for differentiation
9. Reschedule options collapsed behind expandable button
10. App header removed from top of screen
</success_criteria>

<output>
After completion, create `.planning/phases/01.1-ui-refinements/01.1-02-SUMMARY.md`
</output>
